---
import Layout from '../layouts/Layout.astro';
import LatestPublication from '../components/LatestPublication.astro';
import PhotoGallery from '../components/PhotoGallery.astro';
import { getSheehanPublications } from '../utils/pubmed';
import type { PubMedArticle } from '../utils/pubmed';

let latestPublication: PubMedArticle | null = null;
let error: Error | null = null;

try {
  const publications = await getSheehanPublications();
  latestPublication = publications[0];
} catch (e) {
  console.error('Error fetching latest publication:', e);
  error = e instanceof Error ? e : new Error('Unknown error');
}

const labPhotos = [
  {
    src: '/images/events/nicely-dressed-lab-photo.jpg',
    alt: 'Sheehan Lab Group Photo'
  },
  {
    src: '/images/events/lab-members-at-first-conference.jpg',
    alt: 'Lab Members at Conference'
  },
  {
    src: '/images/events/student-proudly-standing-infront-of-poster.jpg',
    alt: 'Student with Research Poster'
  },
  {
    src: '/images/events/post-doc-with-poster.jpg',
    alt: 'Post-doc Presentation'
  },
  {
    src: '/images/events/pi-standing-with-panel-of-colleges-at-conference.jpg',
    alt: 'Dr. Sheehan at Conference Panel'
  },
  {
    src: '/images/events/lab-dinner.jpg',
    alt: 'Lab Dinner'
  },
  {
    src: '/images/events/mumbai-themed-night.jpg',
    alt: 'Mumbai Theme Night'
  },
  {
    src: '/images/events/fun-day-out.jpg',
    alt: 'Lab Outing'
  }
];
---

<Layout title="Sheehan Lab | Sickle Cell Disease Research at Emory University">
	<main>
		<section class="hero">
			<div class="hero-content">
				<h1>Sheehan Lab</h1>
				<p class="subtitle">Advancing Sickle Cell Disease Research and Treatment</p>
				<div class="hero-buttons">
					<a href="/research" class="button explore-research-btn">Explore Our Research</a>
					<a href="/publications" class="button view-publications-btn">View Publications</a>
				</div>
			</div>
		</section>

		<section class="mission">
			<div class="container">
				<h2>Our Mission</h2>
				<p>The Sheehan Lab is dedicated to developing and improving therapies for individuals living with sickle cell disease. Our multifaceted approach combines genomics, clinical research, and innovative biomarker development to better understand and treat this complex disease.</p>
			</div>
		</section>

		<section class="research-highlights">
			<div class="container">
				<h2>Research Focus</h2>
				<div class="highlight-grid">
					<div class="highlight-card">
						<div class="card-icon">ðŸ§¬</div>
						<h3>Genomics & Therapy</h3>
						<p>Identifying genetic factors and new drug targets to increase fetal hemoglobin levels.</p>
					</div>
					<div class="highlight-card">
						<div class="card-icon">ðŸ”¬</div>
						<h3>Pain Management</h3>
						<p>Investigating genetic factors in chronic pain development and biomarker research.</p>
					</div>
					<div class="highlight-card">
						<div class="card-icon">ðŸ§ª</div>
						<h3>Biomarker Development</h3>
						<p>Creating new methods to evaluate red cell function and therapy effectiveness.</p>
					</div>
					<div class="highlight-card">
						<div class="card-icon">ðŸ§¬</div>
						<h3>Gene-Based Therapies</h3>
						<p>Evaluating and improving gene therapy approaches for better patient outcomes.</p>
					</div>
				</div>
			</div>
		</section>

		<section class="latest-updates">
			<div class="container">
				<h2>Latest Publication</h2>
				<div class="updates-content">
					{error && <p class="error">Error loading latest publication. Please try again later.</p>}
					{!error && !latestPublication && <p class="loading">Loading latest publication...</p>}
					{latestPublication && <LatestPublication publication={latestPublication} />}
				</div>
			</div>
		</section>

		<PhotoGallery 
			photos={labPhotos}
			title="Lab Life"
			description="Our team working together to advance sickle cell disease research"
		/>
	</main>

	<style>
		.hero {
			background: linear-gradient(rgba(1, 33, 105, 0.85), rgba(1, 33, 105, 0.9)),
						url('/images/lab-background.jpg') center/cover;
			height: 70vh;
			display: flex;
			align-items: center;
			justify-content: center;
			text-align: center;
			margin-top: 80px;
		}

		.hero-content {
			max-width: 800px;
			padding: 2rem;
			color: #ffffff;
			animation: fadeIn 1s ease-out;
		}

		.hero h1 {
			font-size: 4rem;
			margin-bottom: 1rem;
			color: white;
		}

		.subtitle {
			font-size: 1.5rem;
			opacity: 0.9;
			margin-bottom: 2rem;
			color: #ffffff;
		}

		.hero-buttons {
			margin-top: 1.5rem;
		}

		.button {
			margin: 0 0.5rem;
			padding: 0.8rem 1.5rem;
			border-radius: 4px;
			text-decoration: none;
			transition: all 0.3s ease;
			position: relative;
			overflow: hidden;
			display: inline-block;
			font-weight: 500;
		}

		.explore-research-btn {
			background-color: transparent;
			color: var(--emory-accent);
			border: 1px solid var(--emory-accent);
		}

		.view-publications-btn {
			background-color: transparent;
			border: 1px solid white;
			color: white;
		}

		.latest-paper-btn {
			background-color: transparent;
			color: black;
			border: 1px solid black;
		}

		.button:hover {
			transform: translateY(-2px);
		}

		.explore-research-btn:hover {
			background-color: rgba(255, 255, 255, 0.9);
		}

		.view-publications-btn:hover {
			background-color: rgba(255, 255, 255, 0.1);
		}

		.latest-paper-btn:hover {
			background-color: black;
			color: white;
		}

		.mission {
			padding: 4rem 2rem;
			background: #f8fafc;
			text-align: center;
		}

		.container {
			max-width: 800px;
			margin: 0 auto;
		}

		.research-highlights {
			padding: 6rem 0;
			background: #f8fafc;
		}

		.highlight-grid {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
			gap: 2rem;
			margin-top: 3rem;
		}

		.highlight-card {
			background: white;
			padding: 2rem;
			border-radius: 8px;
			box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
			transition: transform 0.3s ease, box-shadow 0.3s ease;
			animation: fadeIn 0.5s ease-out;
			animation-fill-mode: both;
		}

		.highlight-card:nth-child(1) { animation-delay: 0.1s; }
		.highlight-card:nth-child(2) { animation-delay: 0.2s; }
		.highlight-card:nth-child(3) { animation-delay: 0.3s; }
		.highlight-card:nth-child(4) { animation-delay: 0.4s; }

		.highlight-card:hover {
			transform: translateY(-5px);
			box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
		}

		.card-icon {
			font-size: 2rem;
			margin-bottom: 1rem;
		}

		.latest-updates {
			padding: 4rem 2rem;
			background: #ffffff;
		}

		.updates-grid {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
			gap: 2rem;
		}

		.update-card {
			background: #f8fafc;
			padding: 2rem;
			border-radius: 8px;
			box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
			text-align: center;
		}

		/* Add specific styling for buttons in update cards */
		.update-card .button.primary {
			background-color: black;
			border: 2px solid black;
			color: white;
		}

		.update-card .button.primary:hover {
			background-color: white;
			color: black;
		}

		@media (max-width: 768px) {
			.hero {
				height: 60vh;
				margin-top: 60px;
			}

			.hero h1 {
				font-size: 2.5rem;
			}

			.subtitle {
				font-size: 1.2rem;
			}

			.hero-buttons {
				display: flex;
				flex-direction: column;
				gap: 1rem;
				align-items: center;
			}

			.button {
				width: 100%;
				max-width: 300px;
				margin: 0;
				text-align: center;
			}

			.highlight-grid {
				grid-template-columns: 1fr;
				padding: 0 1rem;
			}

			.container {
				padding: 0 1rem;
			}

			.updates-grid {
				grid-template-columns: 1fr;
			}
		}

		/* Add a subtle parallax effect to the hero */
		.hero {
			background-attachment: fixed;
		}

		/* Add hover effect to cards */
		.highlight-card {
			transition: transform 0.3s ease, box-shadow 0.3s ease;
		}

		.highlight-card:hover {
			transform: translateY(-5px);
			box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
		}

		/* Add a subtle gradient to the news cards */
		.news-card.featured {
			background: linear-gradient(135deg, var(--emory-primary), var(--emory-accent));
		}
	</style>
</Layout>
